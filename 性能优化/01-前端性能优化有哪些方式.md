## 前言

性能优化是必考的综合性问题，主要考察你的知识面是否够广。问的过程中，可以单独问一些细节问题：比如防抖节流、大列表渲染等等。

## 性能优化的总体原则

- 多使用缓存、内存。

- 减少CPU计算量，减少网络加载耗时。

上面两条原则，适用于所有编程的性能优化：用空间换时间。

## 让加载更快

- 减少资源体积：代码逻辑优化（避免写重复代码）、压缩代码、压缩图片&字体等静态资源（建议使用动态字体）、tree shaking 去掉多余代码&重复代码。

- 非核心代码**异步**加载。

网络传输层面：

- 减少访问次数：合并代码、减少http请求数量（比如CSS雪碧图）、多使用缓存（避免重复请求）、SSR服务端渲染

- 使用更快的网络：CDN。静态资源全部放CDN上，使用户可就近获取所需内容，大幅减小光纤传输距离。

- dns预解析：使用dns-prefetch 提前解析域名，提高资源加载速度。在访问以图片为主的网站时，DNS预解析可以让加载时间减少5%左右。

- 避免重定向：301、302 重定向会降低响应速度

- PWA，Service worker


## 让渲染更快


- CSS放在`<head>` 里，尽早渲染样式；JS放在`<body>`内的最下方，避免阻塞 DOM的解析。

- 尽早开始执行 JS，用 DOMContentLoaded 触发。

- 图片懒加载。

- 减少浏览器的重绘和重排。

JS层面：

- 对DOM查询进行缓存。

- 频繁操作DOM时，合并到一起插入DOM树结构。

- 防抖节流。

- 骨架屏 skeleton：减少布局移动

- 无限滚动列表：做节点回收

## 性能分析和诊断工具

- 控制台的 performance工具：日常开发过程中观察分析运行时的性能表现。

- 控制台的 LightHouse ：跑分、输出性能报告，分析性能。

- 控制台的瀑布图 Waterfall。

- Performance 这个API：可以在代码里测量性能。

- [WebPageTest](https://www.webpagetest.org)网站：评估网站性能









