## Node.js性能优化

### 1、API接口相关

（1）接口调用做限频

（2）DB查询加索引

（3）调完中台服务之后，要及时回收资源，避免内存泄露。

### 2、代码逻辑

（1）文件I/O：一次性不要处理过大的数据流，以及图片、视频等大文件。

（2）网络I/O：非核心代码放到异步任务里，避免阻塞主线程。

（3）磁盘I/O：不要写入过多的日志。磁盘I/O会影响机器性能。

### 3、集群服务

（1）多进程：通过PM2管理工具开启多进程。访问量大时，避免单个进程超出内存上限。

（2）多机器：部署多台机器。避免单个机器挂掉时，整个服务宕机。

### 4、监控系统

监控如下性能参数：

（1）API接口可用率

（2）服务的进程有没有挂掉

（3）CPU使用率

（4）内存占用情况

（5）通过日志文件、内存快照文件，定位问题

### 5、压测和演习

（1）接口压测

（2）容灾演习